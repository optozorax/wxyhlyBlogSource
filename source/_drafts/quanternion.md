本文假设读者已经知道复数几何意义的相关知识（可参考维度数学漫步5、6集）。
我们直到，复数就是引入了$i$——它满足$i^2=-1$，从这点出发就可以推出非常多几何上代数上的东西。当然人们也在做尝试构造类似数推广到更高维空间。下面我们就来看看它的四维推广——四元数。我们将给出四元数在四维空间中的几何意义，揭示它的真面目。按照我们的习惯，应该先把复数推广到三元数，然后再是四元数，然而经过一些数学家的努力他们发现三元数是不存在的！下面我们先看看四元数的样子：
$$i^2=-1, j^2=-1, k^2=-1, ij=-ji=k, jk=-kj=i, ki=-ik=j$$
我们看到四元数的乘法不满足交换律！最初我很难适应这种连交换律都不满足的系统有什么意思，但我们将看到四元数能表示四维空间中的旋转，跟三维空间一样旋转的次序不同结果会不一样。比如绕x轴转90°然后绕y轴转90°不等于绕y轴转90°然后绕x轴转90°。
![旋转次序影响结果]()
四元数与旋转一样满足结合律，如$(ij)k=kk=-1=ii=i(jk)$。其实全体四元数构成一个**群**，就像旋转构成旋转群一样（群即满足结合律、可逆性、有单位元等要求的乘法，[参见这里]()）。
### 各种四元数
在具体说四元数怎样表示旋转之前我们先看看为什么要这样规定四元数$i$、$j$、$k$的乘法表，有没有其他替代方案？比如我就是对不满足交换律这一点不满意，我想构造新的“可交换四元数”，这可能吗？（如果你不对这些变种四元数感兴趣可以直接[跳过这一节]()，此节内容独立）注意，这不代表我可以乱往乘法表里填东西，因为有结合律、可逆等等限制（比如还有交换律，如果你还希望有的话）。首先，1乘以任何数都不会变（单位元的性质），这种规律最好不要打破，不然它看上去就不像是数的推广了。之前提到的四元数乘法表中（为与后面“乱七八糟的四元数”区分，我们叫它标准四元数），对于$i$、$j$、$k$，为什么它们的平方都是-1？按理说-1的平方根只有±i就足够了。事实上，数学家证明了复数域已经是**代数闭域**了，通俗来说就是所有多项式的根都是复数，我们不需要再引入新的复数之外的数来表示了。比如甚至$\sqrt{i}{i}$都是一个实数（当然也是复数）。所以从这种意义上说，复数的推广完全是多此一举。现在需要明确目的：我们不是想真的表示更多的数，而纯粹只是对它的代数结构感兴趣。既然没有这些限制，不妨想一些疯狂的事情：
- 如果从实数推广到一种复数，但这种复数里面的i满足的是$i^2=1$会咋样？此时$1^2$也是1，但我们就认为$i$与1不同会怎样？这就是所谓的**双曲复数**，因为它对应于二维双曲空间（闵可夫斯基二维时空）中的几何！它甚至还有自己的欧拉公式，但联系的是复指数与双曲函数，而不是三角函数。
- 如果$i^2=0$但i与0又不相同会怎样？这也是一种新的复数系统，但由于它的几何意义不明显我们就不关注了（它有明显的代数意义：无穷小量！无穷小量不等于零，但我们忽略高阶无穷小量，即无穷小量的平方为0）。

跟研究四维空间方法一样，我们研究清楚低维后下面转战高维的四元数。我们先忘掉标准四元数，先来盲目构造：我们知道复数可以写成2*2的实数矩阵，这样复数的四则运算就对应矩阵的四则运算（矩阵相除这里理解为乘以另一个矩阵的逆），这启发我们如果矩阵里填入的是复数就得到了一种双重复数。抛开矩阵来说就是设$Z = A + B I$，而A和B都是复数。设$A=a+bi$、$B=c+di$，注意我们必须假设Z里面的I不等于A、B里面的i，否则就合并了还是得到一般的复数，因为代进去变成$Z = (a+bi) + (c+di)i) = a + bi + ci -d = a-d + (b+c)i$。区分两种i我们得到$Z = (a+bi) + (c+di)I = a+bi+cI+diI$。这正是一种四元数！我们记$I=j, iI=k$，则$Z = a+bi+cj+dk$，还有相应的乘法法则：$i^2=-1, j^2=I^2=-1, ij=iI=k$，问题是$k^2=(iI)^2=iIiI$等于多少？由于我们定义的i和I都是复数，它们的乘法满足交换律，所以$iI=Ii$（其实是不太严谨的推导），$$k^2=iiII=1$。这种四元数同时将正常复数与双曲复数都包含了，而且满足交换律！下面整理一下乘法表：

这就是可交换的四元数——双复数！为什么它不是正统的四元数呢？因为从它出发得到的几何中，线段长度的平方都是个复数（等于$A^2+B^2$），所以没直观几何意义。
同理如果i、j、k中有两个数的平方是1，我们得到双曲四元数，但注意它**不能**表示闵可夫斯基四维时空（勾股定理为$x^2+y^2+z^2-t^2=线长^2$的空间，即3空间+1维时间，注意区别于四维几何空间$x^2+y^2+z^2+w^2=线长^2$），它表示的是一种怪时空$x^2+y^2-z^2-t^2=线长^2$——那里有2维的空间和2维的时间！（那个世界中时间与空间地位相同，有高度的对称性，这只是从数学度规号差的角度说的，我无法想象里面的物理学）但同样没有交换律；最后，如果i、j、k三个数的平方都是1，我们得到一种同构于克莱因四元群的东西，满足交换律，但没啥几何意义。实际上，我们貌似找不到能够表示闵可夫斯基四维时空的四元数。好了，下节我们将回到对应四维欧几里得几何的标准四元数上。
## 计算机图形学中的四元数 
四元数能表示四维旋转，那它当然就能表示三维旋转。我们先从三维空间来窥探一下四元数。实际上它被广泛用于计算机图形学。如果你在网上搜索四元数的话，最常见的内容应该就是怎样用四元数表示绕给定轴$a$旋转给定角度$\theta$的方法了：
首先我们把三维坐标$(x,y,z)$对应到一个四元数$A=xj+yj+zk$，注意这个四元数没有实部，只有三个虚部，然后计算四元数$Q=cos\theta/2 + A sin\theta$，这个四元数就表示了绕给定轴$a$旋转给定角度$\theta/2$。它旋转向量$x$得到的新向量$x'$由下面公式计算：
$x'=QxQ*$，其中$Q=a+bi+cj+dk$，我们记$Q*=a-bi-cj-dk$，叫做$Q$的共轭。
公式给出来了，应对三维旋转计算就没问题了，只是计算过程中要时刻注意四元数没有交换律。但为什么这样做就能得到正确的旋转？网上一般是基于几何代数的解释，比如参看[这篇文章]()（此文作者就是开发4DToys的那个人！）
